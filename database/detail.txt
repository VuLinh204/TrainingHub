Toàn bộ dữ liệu vận hành xoay quanh 4 nhóm thực thể chính:
👤 Nhân viên (Employee) → 📚 Khóa học (Subject) → 🧠 Bài thi (Exam) → 🏅 Chứng chỉ (Certificate)
và hệ thống hỗ trợ như Theo dõi (WatchLog, Completion), Phân quyền (Position, Assign), Thông báo (Notification).

🧩 1️⃣ Nhân viên – tblTrain_Employee

Trung tâm của hệ thống, là người học, làm bài thi, nhận chứng chỉ.

Mỗi nhân viên (Employee) thuộc một chức danh / vị trí (PositionID → tblTrain_Position).

Một nhân viên có thể:

Được phân công học các khóa (tblTrain_Assign theo PositionID).

Xem video / học khóa học (tblTrain_WatchLog).

Làm bài thi (tblTrain_Exam).

Hoàn thành khóa học (tblTrain_Completion).

Nhận chứng chỉ (tblTrain_Certificate).

Nhận thông báo (tblTrain_Notification).

🏢 2️⃣ Chức danh – tblTrain_Position

Xác định nhóm nhân viên (VD: nhân viên bán hàng, quản lý, kỹ sư...)

Mỗi chức danh có thể được phân công nhiều môn học thông qua tblTrain_Assign.

Mỗi nhân viên liên kết đến 1 PositionID.

📚 3️⃣ Khóa học – tblTrain_Subject

Đơn vị học tập chính, gồm video, tài liệu, và bài kiểm tra.

Mỗi Subject thuộc một nhóm kiến thức (tblTrain_KnowledgeGroup).

Mỗi Subject có nhiều:

Câu hỏi (tblTrain_Question)

Bài thi (tblTrain_Exam)

Log học tập (tblTrain_WatchLog)

Hoàn thành (tblTrain_Completion)

Chứng chỉ (tblTrain_Certificate)

Các trường như MinWatchPercent, RequiredScore quy định điều kiện đạt.

🧮 4️⃣ Bài thi – tblTrain_Exam

Ghi lại mỗi lần nhân viên làm bài kiểm tra của một khóa học.

Liên kết:

EmployeeID → tblTrain_Employee

SubjectID → tblTrain_Subject

Khi trạng thái đổi sang completed, trigger cập nhật CompletedAt và Passed.

Chi tiết câu trả lời lưu trong tblTrain_ExamDetail:

ExamDetail nối Exam + Question + Answer.

🧠 5️⃣ Câu hỏi – tblTrain_Question và Đáp án – tblTrain_Answer

Mỗi môn học có danh sách câu hỏi; mỗi câu hỏi có nhiều đáp án.

tblTrain_Question.SubjectID → tblTrain_Subject.ID

tblTrain_Answer.QuestionID → tblTrain_Question.ID

tblTrain_ExamDetail chứa lựa chọn của người học để chấm điểm.

🎬 6️⃣ Theo dõi học tập – tblTrain_WatchLog và Hoàn thành – tblTrain_Completion

Hai bảng này ghi nhận tiến độ.

tblTrain_WatchLog lưu từng hành động (pause, resume, seek, heartbeat…)

tblTrain_Completion lưu bản ghi tổng kết rằng nhân viên đã hoàn thành môn học nào, theo phương thức gì (video / exam / manual).

tblTrain_Completion có thể do admin đánh dấu hoàn thành (CreatedBy).

🏅 7️⃣ Chứng chỉ – tblTrain_Certificate

Sinh ra khi nhân viên hoàn thành khóa học đạt yêu cầu.

EmployeeID → tblTrain_Employee

SubjectID → tblTrain_Subject

Chỉ 1 chứng chỉ hợp lệ cho mỗi (Employee, Subject)

Có thời hạn (ExpiresAt), tình trạng thu hồi (RevokedAt, RevokedBy).

Có trigger sinh CertificateHash (chống giả mạo).

Có ApprovedBy, ApprovedAt để admin duyệt.

📢 8️⃣ Thông báo – tblTrain_Notification

Gửi thông báo cho nhân viên khi:

Có chứng chỉ được cấp.

Bài thi hoàn thành.

Khóa học được gán.

📊 9️⃣ Luồng dữ liệu tổng thể

Toàn bộ chu trình vận hành như sau:

(1) Admin tạo KnowledgeGroup & Subject
 ↓
(2) Admin gán Subject cho Position (tblTrain_Assign)
 ↓
(3) Nhân viên (theo PositionID) thấy khóa học trong danh sách của họ
 ↓
(4) Nhân viên xem video → lưu WatchLog liên tục
 ↓
(5) Khi đạt MinWatchPercent, họ làm bài thi → lưu vào tblTrain_Exam (+ExamDetail)
 ↓
(6) Hệ thống tính Score, cập nhật Passed & CompletedAt
 ↓
(7) Nếu Passed = 1 → thêm bản ghi vào tblTrain_Completion
 ↓
(8) Nếu đủ điều kiện → sinh chứng chỉ (tblTrain_Certificate)
 ↓
(9) Gửi thông báo (tblTrain_Notification)
 ↓
(10) Admin xem thống kê qua Dashboard (query từ các bảng trên)


🧭 Mối quan hệ chính (tóm tắt dạng nói)
Bảng chính	Liên kết với	Loại quan hệ
Employee	Position	    N-1
Employee	Exam	        1-N
Employee	Completion	    1-N
Employee	Certificate	    1-N
Employee	WatchLog	    1-N
Subject	    KnowledgeGroup	N-1
Subject	    Question	    1-N
Subject	    Exam	        1-N
Subject	    Completion	    1-N
Subject	    Certificate	    1-N
Position	Assign	        1-N
Assign	    Subject	        N-1
Question	Answer	        1-N
Exam	    ExamDetail	    1-N